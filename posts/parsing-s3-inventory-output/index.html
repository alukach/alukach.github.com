<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Parsing S3 Inventory CSV output in Python | anthony lukach</title><meta name=description content="A collection of notes."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Parsing S3 Inventory CSV output in Python"><meta property="og:description" content="S3 Inventory is a great way to access a large number of keys in an S3 Bucket. Its output is easily parsed by AWS Athena, enabling queries across the key names (e.g. find all keys ending with .png)
However, sometimes you just need to list all of the keys mentioned in the S3 Inventory output (e.g. populating an SQS queue with every keyname mentioned in an inventory output). The following code is an example of doing such task in Python:"><meta property="og:type" content="article"><meta property="og:url" content="https://alukach.com/posts/parsing-s3-inventory-output/"><meta property="article:published_time" content="2019-12-16T00:00:00+00:00"><meta property="article:modified_time" content="2019-12-16T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Parsing S3 Inventory CSV output in Python"><meta name=twitter:description content="S3 Inventory is a great way to access a large number of keys in an S3 Bucket. Its output is easily parsed by AWS Athena, enabling queries across the key names (e.g. find all keys ending with .png)
However, sometimes you just need to list all of the keys mentioned in the S3 Inventory output (e.g. populating an SQS queue with every keyname mentioned in an inventory output). The following code is an example of doing such task in Python:"><link rel=stylesheet href=https://alukach.com/css/style-white.css><link rel=stylesheet href=https://alukach.com/css/custom.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://alukach.com/images/favicon.ico><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-16401510-1','auto');ga('send','pageview');}</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Writings</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://alukach.com/posts/pil_friendly_s3_file/><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://alukach.com/posts/aws-s3-batch-operation-lambda-boilerplate/><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=#><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f"><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&text=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&title=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&is_video=false&description=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python&body=Check out this article: https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f"><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&title=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&title=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&title=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-stumbleupon" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&title=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-digg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&name=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python&description=S3%20Inventory%20is%20a%20great%20way%20to%20access%20a%20large%20number%20of%20keys%20in%20an%20S3%20Bucket.%20Its%20output%20is%20easily%20parsed%20by%20AWS%20Athena%2c%20enabling%20queries%20across%20the%20key%20names%20%28e.g.%20find%20all%20keys%20ending%20with%20.png%29%0aHowever%2c%20sometimes%20you%20just%20need%20to%20list%20all%20of%20the%20keys%20mentioned%20in%20the%20S3%20Inventory%20output%20%28e.g.%20populating%20an%20SQS%20queue%20with%20every%20keyname%20mentioned%20in%20an%20inventory%20output%29.%20The%20following%20code%20is%20an%20example%20of%20doing%20such%20task%20in%20Python%3a"><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&t=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Parsing S3 Inventory CSV output in Python</h1><div class=meta><div class=postdate><time datetime="2019-12-16 00:00:00 +0000 UTC" itemprop=datePublished>2019-12-16</time></div><div class=article-tag><i class="fas fa-tag"></i><a class=tag-link href=/tags/python rel=tag>python</a>
,
<a class=tag-link href=/tags/s3 rel=tag>s3</a>
,
<a class=tag-link href=/tags/inventory rel=tag>inventory</a>
,
<a class=tag-link href=/tags/csv rel=tag>csv</a></div></div></header><div class=content itemprop=articleBody><p><a href=https://docs.aws.amazon.com/AmazonS3/latest/dev/storage-inventory.html>S3 Inventory</a> is a great way to access a large number of keys in an S3 Bucket. Its output is easily parsed by <a href=https://docs.aws.amazon.com/athena/latest/ug//what-is.html>AWS Athena</a>, enabling queries across the key names (e.g. find all keys ending with <code>.png</code>)</p><p>However, sometimes you just need to list all of the keys mentioned in the S3 Inventory output (e.g. populating an SQS queue with every keyname mentioned in an inventory output). The following code is an example of doing such task in Python:</p><script type=application/javascript src=https://gist.github.com/alukach/1a2b8b6366410fb94fa5cee7f72ee304.js></script></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Writings</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f"><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&text=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&title=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&is_video=false&description=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python&body=Check out this article: https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f"><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&title=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&title=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&title=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-stumbleupon fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&title=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-digg fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&name=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python&description=S3%20Inventory%20is%20a%20great%20way%20to%20access%20a%20large%20number%20of%20keys%20in%20an%20S3%20Bucket.%20Its%20output%20is%20easily%20parsed%20by%20AWS%20Athena%2c%20enabling%20queries%20across%20the%20key%20names%20%28e.g.%20find%20all%20keys%20ending%20with%20.png%29%0aHowever%2c%20sometimes%20you%20just%20need%20to%20list%20all%20of%20the%20keys%20mentioned%20in%20the%20S3%20Inventory%20output%20%28e.g.%20populating%20an%20SQS%20queue%20with%20every%20keyname%20mentioned%20in%20an%20inventory%20output%29.%20The%20following%20code%20is%20an%20example%20of%20doing%20such%20task%20in%20Python%3a"><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2falukach.com%2fposts%2fparsing-s3-inventory-output%2f&t=Parsing%20S3%20Inventory%20CSV%20output%20in%20Python"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu class=icon href=# onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc class=icon href=# onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share class=icon href=# onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2021 Anthony Lukach</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Writings</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script></html>